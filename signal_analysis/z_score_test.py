import pandas as pd
from signal_analysis.tool import trading_system_z_score

# --- 示例 ---
# | Z-score 范围 | 区域名称 | 系统解读 | 你的行动指南 |
# | :--- | :--- | :--- | :--- |
# | **> +1.96**       | 🟩 **显著交替区 (Alternating)** | **系统有效，性格为“均值回归”。** 盈利后极易出现亏损，亏损后极易出现盈利。这很不寻"常，证明系统有非随机的特性。 | **反向调整风险！** 刚盈利一笔？下一笔要格外谨慎，可考虑减小仓位。刚亏损一笔？下一笔成功的概率在统计上更高。 |
# | **+1.0 到 +1.96** | 🟨 **弱交替倾向区**             | **系统可能有效，有交替倾向。** 结果并非完全随机，但模式不够强大，不足以作为坚实的决策依据。 | 保持警惕，但不必仅因此改变操作。继续观察，看Z-score是否会变得更强。 |
# | **-1.0 到 +1.0**  | ⬜ **随机区 (Random)**         | **系统可能是随机的。** 至少在盈亏序列上，看不出任何规律。上一次交易的结果对下一次没有任何预测价值，就像抛硬币。 | **放弃从序列中寻找规律！** 你的优势必须来自其他方面（如胜率、盈亏比）。严格执行每笔交易，不要被上一笔的结果影响。 |
# | **-1.96 到 -1.0** | 🟨 **弱连续倾向区**             | **系统可能有效，有“抱团”倾向。** 盈利或亏损可能倾向于扎堆出现，但信号不强。 | 开始注意风险控制，尤其是在连续亏损后。这可能是一个“热手”系统的早期迹象。 |
# | **< -1.96**       | 🟥 **显著连续区 (Streaky)**     | **系统有效，性格为“动量/趋势”。** 盈利和亏损都极易连续出现，形成“连胜”和“连败”周期。这是非常重要的非随机特性。 | **顺势调整风险！** 连续亏损2-3次？**必须**减小仓位或暂停交易以规避“亏损周期”。连续盈利？可以考虑保持仓位，抓住“盈利周期”。 |
# 1 代表盈利, -1 代表亏损
win_value = 1
loss_value = -1

csv_file = 'data/z_score_test.csv'
df = pd.read_csv(csv_file)
if len(df) < 30:
    print("交易次数过少，无法计算。")
    exit()

winorloss_field = 'winorloss'
z_score = trading_system_z_score(df[winorloss_field].tolist(), win_value, loss_value)
print(f"Z-score: {z_score:.4f}")